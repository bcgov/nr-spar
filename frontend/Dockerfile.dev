FROM node:16.19.1-alpine3.17
ENV PORT=3000

# Packages
RUN apk add --no-cache python3 g++ make

# Port and Healthcheck
EXPOSE ${PORT}
HEALTHCHECK --interval=5s --timeout=5s --retries=5 --start-period=30s \
    CMD wget --no-verbose --tries=1 --spider http://localhost:${PORT} || exit 1

# Start
WORKDIR /app
CMD ["sh", "-c", "yarn install --frozen-lockfile --prefer-offline && yarn start"]
