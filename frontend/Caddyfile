{
  auto_https off
  admin off
}

:3000
root * /app/dist

file_server

@www_host {
  host www.{$HOST_ROUTE}
}

redir @www_host http://{$HOST_ROUTE}{path}

@unspecified_path {
  not path_regexp ^\/0.0.0.0
  not path /api/*
}

handle @unspecified_path {
  try_files {path} {path}/ /?_url={uri}
}

handle /env-config.js {
  header Content-Type text/javascript
  respond `window.config = {
    VITE_KC_URL: "{$VITE_KC_URL}",
    VITE_KC_REALM: "standard",
    VITE_KC_CLIENT_ID: "seed-planning-test-4296",
    VITE_NRSPARWEBAPP_VERSION: "${VITE_NRSPARWEBAPP_VERSION}",
    VITE_SERVER_URL: "{$VITE_SERVER_URL}",
    VITE_ORACLE_SERVER_URL: "{$VITE_ORACLE_SERVER_URL}"
  };`
}

encode gzip

log {
  output stdout
  level {$LOG_LEVEL}
}
